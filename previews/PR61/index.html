<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · TMLE.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://olivierlabayle.github.io/TMLE.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/logo.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.svg" alt="TMLE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>TMLE.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Mathematical-setting"><span>Mathematical setting</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Quick-Start"><span>Quick Start</span></a></li></ul></li><li><a class="tocitem" href="user_guide/">User Guide</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="examples/super_learning/">Becoming a Super Learner</a></li></ul></li><li><a class="tocitem" href="api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/olivierlabayle/TMLE.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Home"><a class="docs-heading-anchor" href="#Home">Home</a><a id="Home-1"></a><a class="docs-heading-anchor-permalink" href="#Home" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>TMLE.jl is a Julia implementation of the Targeted Minimum Loss-Based Estimation (<a href="https://link.springer.com/book/10.1007/978-1-4419-9782-1">TMLE</a>) framework. If you are interested in efficient and unbiased estimation of some causal effect, you are in the right place. Since TMLE uses machine-learning methods to estimate nuisance parameters, the present package is based upon <a href="https://alan-turing-institute.github.io/MLJ.jl/dev/">MLJ</a>. This means that any model respecting the MLJ interface can be used for the estimation of nuisance parameters.</p><h2 id="Mathematical-setting"><a class="docs-heading-anchor" href="#Mathematical-setting">Mathematical setting</a><a id="Mathematical-setting-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-setting" title="Permalink"></a></h2><p>Even though the TMLE framework is not restricted to causal inference, the scope of the present package is currently restricted to so called &quot;causal effects&quot; and the following causal graph is assumed throughout:</p><div style="text-align:center">
<img src="assets/causal_graph.png" alt="Causal Model" style="width:400px;"/>
</div><p>whith the following general interpration of variables:</p><ul><li>Y: The Target</li><li>T: The Treatment</li><li>W: Confounders</li><li>C: Extra Covariates</li></ul><p>This graph encodes a factorization of the joint probability distribution <span>$P_0$</span> that we assume generated the observed data:</p><p class="math-container">\[P_0(Y, T, W, C) = P_0(Y|T, W, C) \cdot P_0(T|W) \cdot P_0(W) \cdot P_0(C)\]</p><p>Usually, we don&#39;t have much information about <span>$P_0$</span> and don&#39;t want to make unrealistic assumptions, thus we will simply state that <span>$P_0 \in \mathcal{M}$</span> where <span>$\mathcal{M}$</span> is the space of all probability distributions. It turns out that most target quantities of interest in causal inference can be expressed as real-valued functions of <span>$P_0$</span>, denoted by: <span>$\Psi:\mathcal{M} \rightarrow \Re$</span>. TMLE works by finding a suitable estimator <span>$\hat{P}_n$</span> of <span>$P_0$</span> and then simply substituting it into <span>$\Psi$</span>. Fortunately, it is often non necessary to come up with an estimator of the joint distribution <span>$P_0$</span>, instead only subparts of it are required. Those are called nuisance parameters because they are not of direct interest and for our purposes, only two nuisance parameters are necessary:</p><p class="math-container">\[Q_0(t, w, c) = \mathbb{E}[Y|T=t, W=w, C=c]\]</p><p>and</p><p class="math-container">\[G_0(t, w) = P(T=t|W=w)\]</p><p>Specifying which machine-learning method to use for each of those nuisance parameter is the only ingredient you will need to run a targeted estimation for any of the following quantities. Those quantities have a causal interpretation under suitable assumptions that we do not discuss here.</p><h3 id="The-Conditional-Mean"><a class="docs-heading-anchor" href="#The-Conditional-Mean">The Conditional Mean</a><a id="The-Conditional-Mean-1"></a><a class="docs-heading-anchor-permalink" href="#The-Conditional-Mean" title="Permalink"></a></h3><p>This is simply the expected value of the target <span>$Y$</span> when the treatment is set to <span>$t$</span>.</p><p class="math-container">\[CM_t(P) = \mathbb{E}[\mathbb{E}[Y|T=t, W]]\]</p><h3 id="The-Average-Treatment-Effect-(ATE)"><a class="docs-heading-anchor" href="#The-Average-Treatment-Effect-(ATE)">The Average Treatment Effect (ATE)</a><a id="The-Average-Treatment-Effect-(ATE)-1"></a><a class="docs-heading-anchor-permalink" href="#The-Average-Treatment-Effect-(ATE)" title="Permalink"></a></h3><p>Probably the most famous quantity in causal inference. Under suitable assumptions, tt represents the additive effect of changing the treatment value from <span>$t_1$</span> to <span>$t_2$</span>.</p><p class="math-container">\[ATE_{t_1 \rightarrow t_2}(P) = \mathbb{E}[\mathbb{E}[Y|T=t_2, W]] - \mathbb{E}[\mathbb{E}[Y|T=t_1, W]]\]</p><h3 id="Interaction-Average-Treatment-Effect-(IATE)"><a class="docs-heading-anchor" href="#Interaction-Average-Treatment-Effect-(IATE)">Interaction Average Treatment Effect (IATE)</a><a id="Interaction-Average-Treatment-Effect-(IATE)-1"></a><a class="docs-heading-anchor-permalink" href="#Interaction-Average-Treatment-Effect-(IATE)" title="Permalink"></a></h3><p>If you are interested in the interaction effect of multiple treatments, the IATE is for you. An example formula is displayed below for two interacting treatments whose values are both changed from <span>$0$</span> to <span>$1$</span>:</p><p class="math-container">\[IATE_{0 \rightarrow 1, 0 \rightarrow 1}(P) = \mathbb{E}[\mathbb{E}[Y|T_1=1, T_2=1, W]] - \mathbb{E}[\mathbb{E}[Y|T_1=1, T_2=0, W]]  \\
- \mathbb{E}[\mathbb{E}[Y|T_1=0, T_2=1, W]] + \mathbb{E}[\mathbb{E}[Y|T_1=0, T_2=0, W]] \]</p><h3 id="Any-function-of-the-previous-Parameters"><a class="docs-heading-anchor" href="#Any-function-of-the-previous-Parameters">Any function of the previous Parameters</a><a id="Any-function-of-the-previous-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Any-function-of-the-previous-Parameters" title="Permalink"></a></h3><p>As a result of Julia&#39;s automatic differentiation facilities, given a set of already estimated parameters <span>$(\Psi_1, ..., \Psi_k)$</span>, we can automatically compute an estimator for <span>$f(\Psi_1, ..., \Psi_k)$</span>.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>TMLE.jl can be installed via the Package Manager and supports Julia <code>v1.6</code> and greater.</p><pre><code class="language-Pkg hljs">Pkg&gt; add TMLE</code></pre><h2 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h2><p>To run an estimation procedure, we need 3 ingredients:</p><ul><li>A dataset</li><li>A parameter of interest</li><li>A nuisance parameters specification</li></ul><p>For instance, assume the following simple data generating process:</p><p class="math-container">\[\begin{aligned}
W  &amp;\sim \mathcal{Uniform}(0, 1) \\
T  &amp;\sim \mathcal{Bernoulli}(expit(1-2 \cdot W)) \\
Y  &amp;\sim \mathcal{Normal}(1 + 3 \cdot T - T \cdot W, 0.01)
\end{aligned}\]</p><p>which can be simulated in Julia by:</p><pre><code class="language-julia hljs">using Distributions
using StableRNGs
using Random
using CategoricalArrays
using MLJLinearModels
using TMLE

rng = StableRNG(123)
n = 100
W = rand(rng, Uniform(), n)
T = rand(rng, Uniform(), n) .&lt; TMLE.expit(1 .- 2W)
Y = 1 .+ 3T .- T.*W .+ rand(rng, Normal(0, 0.01), n)
dataset = (Y=Y, T=categorical(T), W=W)</code></pre><p>And say we are interested in the <span>$ATE_{0 \rightarrow 1}(P_0)$</span>:</p><pre><code class="language-julia hljs">Ψ = ATE(
    target      = :Y,
    treatment   = (T=(case=1, control = 0),),
    confounders = [:W]
)</code></pre><p>Note that in this example the ATE can be computed exactly and is given by:</p><p class="math-container">\[ATE_{0 \rightarrow 1}(P_0) = \mathbb{E}[1 + 3 - W] - \mathbb{E}[1] = 3 - \mathbb{E}[W] = 2.5\]</p><p>We next need to define the strategy for learning the nuisance parameters <span>$Q$</span> and <span>$G$</span>, here we keep things simple and simply use generalized linear models:</p><pre><code class="language-julia hljs">η_spec = NuisanceSpec(
    LinearRegressor(),
    LogisticClassifier(lambda=0)
)</code></pre><p>We are now ready to run the TMLE procedure and look the associated confidence interval:</p><pre><code class="language-julia hljs">result, _, _ = tmle(Ψ, η_spec, dataset)
test_result = OneSampleTTest(result, 2.5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">One sample t-test
-----------------
Population details:
    parameter of interest:   Mean
    value under h_0:         2.5
    point estimate:          2.49314
    95% confidence interval: (2.434, 2.552)

Test summary:
    outcome with 95% confidence: fail to reject h_0
    two-sided p-value:           0.8180

Details:
    number of observations:   100
    t-statistic:              -0.23073259152401102
    degrees of freedom:       99
    empirical standard error: 0.029727669021042354
</code></pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="user_guide/">User Guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 9 September 2022 21:13">Friday 9 September 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
